<!-- éŒ¯èª¤è™•ç†æŒ‡å— -->
<div class="error-guide-section">
    <div class="container">
        <h1>ğŸ›¡ï¸ éŒ¯èª¤è™•ç†æŒ‡å—</h1>
        <p class="guide-intro">
            å®Œæ•´çš„ SEO Analyzer API éŒ¯èª¤è™•ç†æŒ‡å—ï¼Œå¹«åŠ©æ‚¨å»ºç«‹å¥å£¯çš„æ‡‰ç”¨ç¨‹å¼ä¸¦å„ªé›…åœ°è™•ç†å„ç¨®ç•°å¸¸æƒ…æ³ã€‚
        </p>

        <!-- å¿«é€ŸéŒ¯èª¤æŸ¥è©¢ -->
        <div class="error-lookup-section">
            <h2>ğŸ” å¿«é€ŸéŒ¯èª¤æŸ¥è©¢</h2>
            <div class="error-search">
                <input type="text" id="errorSearch" placeholder="è¼¸å…¥éŒ¯èª¤ç¢¼æˆ–é—œéµå­—æœå°‹..." onkeyup="filterErrors()">
                <div class="error-categories">
                    <button class="category-btn active" onclick="showErrorCategory('all')">å…¨éƒ¨</button>
                    <button class="category-btn" onclick="showErrorCategory('4xx')">4xx å®¢æˆ¶ç«¯éŒ¯èª¤</button>
                    <button class="category-btn" onclick="showErrorCategory('5xx')">5xx æœå‹™ç«¯éŒ¯èª¤</button>
                    <button class="category-btn" onclick="showErrorCategory('network')">ç¶²è·¯éŒ¯èª¤</button>
                </div>
            </div>
        </div>

        <!-- HTTP ç‹€æ…‹ç¢¼åˆ†é¡ -->
        <div class="status-codes-section">
            <h2 id="status-codes">ğŸ“Š HTTP ç‹€æ…‹ç¢¼åˆ†é¡</h2>
            
            <!-- 4xx å®¢æˆ¶ç«¯éŒ¯èª¤ -->
            <div class="error-category" data-category="4xx">
                <h3 class="error-type client-error">4ï¸âƒ£ 4xx å®¢æˆ¶ç«¯éŒ¯èª¤</h3>
                <div class="status-code-grid">
                    <div class="status-card error-4xx" data-error="400">
                        <div class="status-header">
                            <span class="status-code">400</span>
                            <span class="status-name">Bad Request</span>
                        </div>
                        <p class="status-description">è«‹æ±‚æ ¼å¼éŒ¯èª¤æˆ–åƒæ•¸é©—è­‰å¤±æ•—</p>
                        <div class="common-causes">
                            <h5>å¸¸è¦‹åŸå› ï¼š</h5>
                            <ul>
                                <li>JSON æ ¼å¼éŒ¯èª¤</li>
                                <li>å¿…å¡«åƒæ•¸ç¼ºå¤±</li>
                                <li>åƒæ•¸é¡å‹ä¸æ­£ç¢º</li>
                                <li>åƒæ•¸å€¼è¶…å‡ºé™åˆ¶ç¯„åœ</li>
                            </ul>
                        </div>
                    </div>

                    <div class="status-card error-4xx" data-error="422">
                        <div class="status-header">
                            <span class="status-code">422</span>
                            <span class="status-name">Unprocessable Entity</span>
                        </div>
                        <p class="status-description">è«‹æ±‚æ ¼å¼æ­£ç¢ºä½†æ¥­å‹™é‚è¼¯é©—è­‰å¤±æ•—</p>
                        <div class="common-causes">
                            <h5>å¸¸è¦‹åŸå› ï¼š</h5>
                            <ul>
                                <li>é—œéµå­—é•·åº¦ä¸ç¬¦è¦æ±‚ (1-50 å­—å…ƒ)</li>
                                <li>å—çœ¾æè¿°éé•· (>200 å­—å…ƒ)</li>
                                <li>ä¸æ”¯æ´çš„åˆ†æé¸é …çµ„åˆ</li>
                            </ul>
                        </div>
                    </div>

                    <div class="status-card error-4xx" data-error="429">
                        <div class="status-header">
                            <span class="status-code">429</span>
                            <span class="status-name">Too Many Requests</span>
                        </div>
                        <p class="status-description">è¶…é API ä½¿ç”¨é »ç‡é™åˆ¶</p>
                        <div class="common-causes">
                            <h5>é™åˆ¶è¦å‰‡ï¼š</h5>
                            <ul>
                                <li>æ¯åˆ†é˜æœ€å¤š 20 æ¬¡è«‹æ±‚</li>
                                <li>åŒæ™‚ä½µç™¼ä¸è¶…é 5 å€‹è«‹æ±‚</li>
                                <li>å–®ä¸€ IP æ¯å°æ™‚ 100 æ¬¡è«‹æ±‚</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 5xx æœå‹™ç«¯éŒ¯èª¤ -->
            <div class="error-category" data-category="5xx">
                <h3 class="error-type server-error">5ï¸âƒ£ 5xx æœå‹™ç«¯éŒ¯èª¤</h3>
                <div class="status-code-grid">
                    <div class="status-card error-5xx" data-error="500">
                        <div class="status-header">
                            <span class="status-code">500</span>
                            <span class="status-name">Internal Server Error</span>
                        </div>
                        <p class="status-description">æœå‹™å™¨å…§éƒ¨ç™¼ç”Ÿæœªé æœŸçš„éŒ¯èª¤</p>
                        <div class="common-causes">
                            <h5>å¯èƒ½åŸå› ï¼š</h5>
                            <ul>
                                <li>è³‡æ–™åº«é€£æ¥å¤±æ•—</li>
                                <li>è¨˜æ†¶é«”ä¸è¶³</li>
                                <li>ç¨‹å¼ç¢¼åŸ·è¡Œç•°å¸¸</li>
                                <li>ç³»çµ±è³‡æºè€—ç›¡</li>
                            </ul>
                        </div>
                    </div>

                    <div class="status-card error-5xx" data-error="503">
                        <div class="status-header">
                            <span class="status-code">503</span>
                            <span class="status-name">Service Unavailable</span>
                        </div>
                        <p class="status-description">å¤–éƒ¨æœå‹™æš«æ™‚ä¸å¯ç”¨</p>
                        <div class="common-causes">
                            <h5>æœå‹™ä¾è³´ï¼š</h5>
                            <ul>
                                <li>SerpAPI æœå‹™ä¸­æ–·</li>
                                <li>Azure OpenAI API é™åˆ¶</li>
                                <li>ç¶²é çˆ¬å–æœå‹™ç•°å¸¸</li>
                                <li>ç³»çµ±ç¶­è­·ä¸­</li>
                            </ul>
                        </div>
                    </div>

                    <div class="status-card error-5xx" data-error="504">
                        <div class="status-header">
                            <span class="status-code">504</span>
                            <span class="status-name">Gateway Timeout</span>
                        </div>
                        <p class="status-description">è™•ç†è«‹æ±‚è¶…éæ™‚é–“é™åˆ¶</p>
                        <div class="common-causes">
                            <h5>è¶…æ™‚æƒ…æ³ï¼š</h5>
                            <ul>
                                <li>SERP è³‡æ–™æ“·å–è¶…é 15 ç§’</li>
                                <li>ç¶²é çˆ¬å–è¶…é 25 ç§’</li>
                                <li>AI åˆ†æè¶…é 35 ç§’</li>
                                <li>ç¸½è™•ç†æ™‚é–“è¶…é 60 ç§’</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç¶²è·¯éŒ¯èª¤ -->
            <div class="error-category" data-category="network">
                <h3 class="error-type network-error">ğŸŒ ç¶²è·¯é€£æ¥éŒ¯èª¤</h3>
                <div class="network-errors">
                    <div class="network-error-item">
                        <h4>Connection Refused (ECONNREFUSED)</h4>
                        <p>ç„¡æ³•é€£æ¥åˆ° API æœå‹™å™¨ï¼Œé€šå¸¸è¡¨ç¤ºæœå‹™æœªå•Ÿå‹•æˆ–ç¶²è·¯ä¸é€š</p>
                    </div>
                    <div class="network-error-item">
                        <h4>DNS Resolution Failed</h4>
                        <p>ç„¡æ³•è§£æåŸŸåï¼Œæª¢æŸ¥åŸŸåæ‹¼å¯«æˆ– DNS è¨­å®š</p>
                    </div>
                    <div class="network-error-item">
                        <h4>Request Timeout</h4>
                        <p>è«‹æ±‚åœ¨å®¢æˆ¶ç«¯è¨­å®šçš„è¶…æ™‚æ™‚é–“å…§æœªæ”¶åˆ°å›æ‡‰</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- éŒ¯èª¤å›æ‡‰æ ¼å¼ -->
        <div class="error-format-section">
            <h2 id="error-format">ğŸ“‹ éŒ¯èª¤å›æ‡‰æ ¼å¼</h2>
            
            <div class="format-explanation">
                <p>æ‰€æœ‰éŒ¯èª¤å›æ‡‰éƒ½éµå¾ªçµ±ä¸€çš„ JSON æ ¼å¼ï¼Œä¾¿æ–¼ç¨‹å¼åŒ–è™•ç†ï¼š</p>
            </div>

            <div class="error-format-example">
                <h3>æ¨™æº–éŒ¯èª¤å›æ‡‰çµæ§‹</h3>
                <div class="code-example">
                    <div class="code-header">
                        <span>HTTP 400 - åƒæ•¸é©—è­‰éŒ¯èª¤ç¯„ä¾‹</span>
                        <button class="copy-btn" onclick="copyCode('error-format-400')">è¤‡è£½</button>
                    </div>
                    <pre id="error-format-400"><code>{
  "detail": {
    "code": "VALIDATION_ERROR",
    "message": "é—œéµå­—é•·åº¦å¿…é ˆåœ¨ 1-50 å­—å…ƒä¹‹é–“",
    "field": "keyword",
    "provided_value": "é€™æ˜¯ä¸€å€‹è¶…éäº”åå€‹å­—å…ƒé™åˆ¶çš„éå¸¸é•·çš„é—œéµå­—ç¯„ä¾‹æ¸¬è©¦",
    "expected_format": "1-50 å­—å…ƒçš„éç©ºå­—ä¸²",
    "timestamp": "2025-08-23T13:45:30.123Z"
  }
}</code></pre>
                </div>

                <div class="code-example">
                    <div class="code-header">
                        <span>HTTP 503 - å¤–éƒ¨æœå‹™éŒ¯èª¤ç¯„ä¾‹</span>
                        <button class="copy-btn" onclick="copyCode('error-format-503')">è¤‡è£½</button>
                    </div>
                    <pre id="error-format-503"><code>{
  "detail": {
    "code": "SERP_API_ERROR",
    "message": "æœå°‹è³‡æ–™æ“·å–æœå‹™æš«æ™‚ä¸å¯ç”¨ï¼Œè«‹ç¨å¾Œå†è©¦",
    "timestamp": "2025-08-23T13:45:30.123Z",
    "processing_time": 15.7,
    "retry_after": 30,
    "service": "SerpAPI"
  }
}</code></pre>
                </div>

                <div class="code-example">
                    <div class="code-header">
                        <span>HTTP 504 - è™•ç†è¶…æ™‚éŒ¯èª¤ç¯„ä¾‹</span>
                        <button class="copy-btn" onclick="copyCode('error-format-504')">è¤‡è£½</button>
                    </div>
                    <pre id="error-format-504"><code>{
  "detail": {
    "code": "PROCESSING_TIMEOUT",
    "message": "åˆ†æè™•ç†æ™‚é–“è¶…éé™åˆ¶ï¼Œè«‹å˜—è©¦ç°¡åŒ–åˆ†æé¸é …",
    "timestamp": "2025-08-23T13:45:30.123Z",
    "processing_time": 62.3,
    "timeout_limit": 60.0,
    "suggestion": "å»ºè­°é—œé–‰ generate_draft æˆ– include_table é¸é …ä»¥ç¸®çŸ­è™•ç†æ™‚é–“"
  }
}</code></pre>
                </div>
            </div>

            <!-- éŒ¯èª¤ç¢¼å°æ‡‰è¡¨ -->
            <div class="error-codes-table">
                <h3>éŒ¯èª¤ç¢¼å°æ‡‰è¡¨</h3>
                <table class="error-codes-list">
                    <thead>
                        <tr>
                            <th>éŒ¯èª¤ç¢¼</th>
                            <th>HTTP ç‹€æ…‹</th>
                            <th>æè¿°</th>
                            <th>é‡è©¦å»ºè­°</th>
                            <th>ç”¨æˆ¶æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-error="VALIDATION_ERROR">
                            <td><code>VALIDATION_ERROR</code></td>
                            <td class="status-400">400</td>
                            <td>è¼¸å…¥åƒæ•¸é©—è­‰å¤±æ•—</td>
                            <td class="retry-no">âŒ ä¸è¦é‡è©¦</td>
                            <td>ä¿®æ­£è¼¸å…¥åƒæ•¸</td>
                        </tr>
                        <tr data-error="SERP_API_ERROR">
                            <td><code>SERP_API_ERROR</code></td>
                            <td class="status-503">503</td>
                            <td>æœå°‹è³‡æ–™æ“·å–å¤±æ•—</td>
                            <td class="retry-yes">âœ… å¯é‡è©¦</td>
                            <td>ç¨å¾Œå†è©¦</td>
                        </tr>
                        <tr data-error="AI_API_ERROR">
                            <td><code>AI_API_ERROR</code></td>
                            <td class="status-503">503</td>
                            <td>AI åˆ†ææœå‹™éŒ¯èª¤</td>
                            <td class="retry-yes">âœ… å¯é‡è©¦</td>
                            <td>ç¨å¾Œå†è©¦</td>
                        </tr>
                        <tr data-error="SCRAPER_TIMEOUT">
                            <td><code>SCRAPER_TIMEOUT</code></td>
                            <td class="status-504">504</td>
                            <td>ç¶²é çˆ¬å–é€¾æ™‚</td>
                            <td class="retry-maybe">âš ï¸ è¬¹æ…é‡è©¦</td>
                            <td>ç°¡åŒ–åˆ†æé¸é …</td>
                        </tr>
                        <tr data-error="PROCESSING_TIMEOUT">
                            <td><code>PROCESSING_TIMEOUT</code></td>
                            <td class="status-504">504</td>
                            <td>ç¸½è™•ç†æ™‚é–“è¶…é™</td>
                            <td class="retry-maybe">âš ï¸ è¬¹æ…é‡è©¦</td>
                            <td>èª¿æ•´åˆ†æåƒæ•¸</td>
                        </tr>
                        <tr data-error="RATE_LIMIT_EXCEEDED">
                            <td><code>RATE_LIMIT_EXCEEDED</code></td>
                            <td class="status-429">429</td>
                            <td>è¶…éä½¿ç”¨é »ç‡é™åˆ¶</td>
                            <td class="retry-delay">â±ï¸ å»¶é²é‡è©¦</td>
                            <td>ç­‰å¾…å¾Œé‡è©¦</td>
                        </tr>
                        <tr data-error="INTERNAL_ERROR">
                            <td><code>INTERNAL_ERROR</code></td>
                            <td class="status-500">500</td>
                            <td>ç³»çµ±å…§éƒ¨éŒ¯èª¤</td>
                            <td class="retry-yes">âœ… å¯é‡è©¦</td>
                            <td>è¯çµ¡æŠ€è¡“æ”¯æ´</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- é‡è©¦æ©Ÿåˆ¶è¨­è¨ˆ -->
        <div class="retry-section">
            <h2 id="retry-strategy">ğŸ”„ é‡è©¦æ©Ÿåˆ¶è¨­è¨ˆ</h2>
            
            <div class="retry-strategy-overview">
                <p>æ ¹æ“šä¸åŒçš„éŒ¯èª¤é¡å‹ï¼Œæ¡ç”¨é©ç•¶çš„é‡è©¦ç­–ç•¥å¯ä»¥é¡¯è‘—æå‡æ‡‰ç”¨ç¨‹å¼çš„ç©©å®šæ€§ï¼š</p>
            </div>

            <div class="retry-strategies">
                <div class="strategy-card retry-exponential">
                    <h3>ğŸ“ˆ æŒ‡æ•¸é€€é¿ (Exponential Backoff)</h3>
                    <p>é©ç”¨æ–¼æœå‹™ç«¯éŒ¯èª¤ (5xx) å’Œç¶²è·¯éŒ¯èª¤</p>
                    <div class="strategy-details">
                        <h4>é€€é¿å…¬å¼ï¼š</h4>
                        <code>delay = base_delay * (2 ^ retry_count) + random_jitter</code>
                        <h4>å»ºè­°åƒæ•¸ï¼š</h4>
                        <ul>
                            <li><strong>base_delay</strong>: 1-2 ç§’</li>
                            <li><strong>max_delay</strong>: 60 ç§’</li>
                            <li><strong>max_retries</strong>: 3-5 æ¬¡</li>
                            <li><strong>jitter</strong>: 0-1000ms éš¨æ©Ÿå»¶é²</li>
                        </ul>
                    </div>
                </div>

                <div class="strategy-card retry-fixed">
                    <h3>â±ï¸ å›ºå®šé–“éš”é‡è©¦</h3>
                    <p>é©ç”¨æ–¼é€Ÿç‡é™åˆ¶éŒ¯èª¤ (429)</p>
                    <div class="strategy-details">
                        <h4>ä½¿ç”¨ Retry-After æ¨™é ­ï¼š</h4>
                        <code>delay = response.headers['Retry-After'] || 60</code>
                        <h4>å»ºè­°é…ç½®ï¼š</h4>
                        <ul>
                            <li><strong>å›ºå®šå»¶é²</strong>: ä¾ç…§ Retry-After å€¼</li>
                            <li><strong>æœ€å¤§ç­‰å¾…</strong>: 300 ç§’</li>
                            <li><strong>é‡è©¦æ¬¡æ•¸</strong>: 2-3 æ¬¡</li>
                        </ul>
                    </div>
                </div>

                <div class="strategy-card retry-none">
                    <h3>ğŸš« ä¸é‡è©¦</h3>
                    <p>é©ç”¨æ–¼å®¢æˆ¶ç«¯éŒ¯èª¤ (4xx)</p>
                    <div class="strategy-details">
                        <h4>ç«‹å³å¤±æ•—çš„æƒ…æ³ï¼š</h4>
                        <ul>
                            <li>400 - åƒæ•¸æ ¼å¼éŒ¯èª¤</li>
                            <li>422 - æ¥­å‹™é‚è¼¯éŒ¯èª¤</li>
                            <li>401/403 - èªè­‰æˆæ¬ŠéŒ¯èª¤</li>
                        </ul>
                        <h4>è™•ç†æ–¹å¼ï¼š</h4>
                        <ul>
                            <li>è¨˜éŒ„éŒ¯èª¤è©³æƒ…</li>
                            <li>å‘ä½¿ç”¨è€…é¡¯ç¤ºå‹å–„è¨Šæ¯</li>
                            <li>å¼•å°ä½¿ç”¨è€…ä¿®æ­£è¼¸å…¥</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç¨‹å¼ç¢¼ç¯„ä¾‹ -->
        <div class="code-examples-section">
            <h2 id="code-examples">ğŸ’» ç¨‹å¼ç¢¼ç¯„ä¾‹</h2>
            
            <div class="language-tabs">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="showCodeTab('python')">Python</button>
                    <button class="tab-btn" onclick="showCodeTab('javascript')">JavaScript</button>
                    <button class="tab-btn" onclick="showCodeTab('nodejs')">Node.js</button>
                </div>

                <!-- Python éŒ¯èª¤è™•ç† -->
                <div class="tab-content active" id="python">
                    <h3>Python å®Œæ•´éŒ¯èª¤è™•ç†ç¯„ä¾‹</h3>
                    
                    <div class="code-example">
                        <div class="code-header">
                            <span>å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œé‡è©¦æ©Ÿåˆ¶</span>
                            <button class="copy-btn" onclick="copyCode('python-error-handler')">è¤‡è£½</button>
                        </div>
                        <pre id="python-error-handler"><code>import requests
import time
import random
import json
from typing import Dict, Any, Optional
from enum import Enum

class APIError(Exception):
    """API éŒ¯èª¤åŸºé¡"""
    def __init__(self, message: str, error_code: str, status_code: int, response_data: dict = None):
        super().__init__(message)
        self.error_code = error_code
        self.status_code = status_code
        self.response_data = response_data or {}

class RetryStrategy(Enum):
    NO_RETRY = "no_retry"
    EXPONENTIAL_BACKOFF = "exponential_backoff"
    FIXED_DELAY = "fixed_delay"

class SEOAnalyzerClient:
    def __init__(self, base_url: str = "http://localhost:8001", timeout: int = 120):
        self.base_url = base_url
        self.timeout = timeout
        self.session = requests.Session()
        
        # é‡è©¦ç­–ç•¥é…ç½®
        self.retry_config = {
            # ä¸é‡è©¦çš„éŒ¯èª¤
            400: RetryStrategy.NO_RETRY,
            422: RetryStrategy.NO_RETRY,
            401: RetryStrategy.NO_RETRY,
            403: RetryStrategy.NO_RETRY,
            
            # é€Ÿç‡é™åˆ¶ä½¿ç”¨å›ºå®šå»¶é²
            429: RetryStrategy.FIXED_DELAY,
            
            # æœå‹™ç«¯éŒ¯èª¤ä½¿ç”¨æŒ‡æ•¸é€€é¿
            500: RetryStrategy.EXPONENTIAL_BACKOFF,
            502: RetryStrategy.EXPONENTIAL_BACKOFF,
            503: RetryStrategy.EXPONENTIAL_BACKOFF,
            504: RetryStrategy.EXPONENTIAL_BACKOFF,
        }

    def _exponential_backoff(self, retry_count: int, base_delay: float = 1.0, max_delay: float = 60.0) -> float:
        """è¨ˆç®—æŒ‡æ•¸é€€é¿å»¶é²æ™‚é–“"""
        delay = base_delay * (2 ** retry_count)
        delay = min(delay, max_delay)
        # æ·»åŠ éš¨æ©ŸæŠ–å‹•é¿å…é©šç¾¤æ•ˆæ‡‰
        jitter = random.uniform(0, min(1.0, delay * 0.1))
        return delay + jitter

    def _get_retry_strategy(self, status_code: int) -> RetryStrategy:
        """æ ¹æ“š HTTP ç‹€æ…‹ç¢¼æ±ºå®šé‡è©¦ç­–ç•¥"""
        return self.retry_config.get(status_code, RetryStrategy.NO_RETRY)

    def _should_retry(self, error: requests.RequestException, retry_count: int, max_retries: int = 3) -> tuple[bool, float]:
        """åˆ¤æ–·æ˜¯å¦æ‡‰è©²é‡è©¦åŠè¨ˆç®—å»¶é²æ™‚é–“"""
        if retry_count >= max_retries:
            return False, 0
            
        if isinstance(error, requests.exceptions.Timeout):
            # è¶…æ™‚éŒ¯èª¤ä½¿ç”¨æŒ‡æ•¸é€€é¿
            delay = self._exponential_backoff(retry_count)
            return True, delay
            
        if isinstance(error, requests.exceptions.ConnectionError):
            # é€£æ¥éŒ¯èª¤ä½¿ç”¨æŒ‡æ•¸é€€é¿
            delay = self._exponential_backoff(retry_count)
            return True, delay
            
        if hasattr(error, 'response') and error.response:
            strategy = self._get_retry_strategy(error.response.status_code)
            
            if strategy == RetryStrategy.NO_RETRY:
                return False, 0
            elif strategy == RetryStrategy.FIXED_DELAY:
                # ä½¿ç”¨ Retry-After æ¨™é ­æˆ–é è¨­ 60 ç§’
                retry_after = error.response.headers.get('Retry-After', '60')
                try:
                    delay = float(retry_after)
                except ValueError:
                    delay = 60.0
                return True, min(delay, 300)  # æœ€å¤šç­‰å¾… 5 åˆ†é˜
            elif strategy == RetryStrategy.EXPONENTIAL_BACKOFF:
                delay = self._exponential_backoff(retry_count)
                return True, delay
                
        return False, 0

    def _parse_api_error(self, response: requests.Response) -> APIError:
        """è§£æ API éŒ¯èª¤å›æ‡‰"""
        try:
            error_data = response.json()
            detail = error_data.get('detail', {})
            
            if isinstance(detail, dict):
                error_code = detail.get('code', 'UNKNOWN_ERROR')
                message = detail.get('message', f'HTTP {response.status_code} éŒ¯èª¤')
            else:
                # ç°¡å–®å­—ä¸²éŒ¯èª¤
                error_code = 'API_ERROR'
                message = str(detail)
                
        except json.JSONDecodeError:
            error_code = 'INVALID_RESPONSE'
            message = f'HTTP {response.status_code}: {response.text}'
            detail = {}
            
        return APIError(message, error_code, response.status_code, detail)

    def analyze_seo(self, keyword: str, audience: str, options: dict = None, max_retries: int = 3) -> dict:
        """
        åŸ·è¡Œ SEO åˆ†æï¼ŒåŒ…å«å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œé‡è©¦æ©Ÿåˆ¶
        """
        if options is None:
            options = {"generate_draft": False, "include_faq": False, "include_table": False}
            
        payload = {"keyword": keyword, "audience": audience, "options": options}
        url = f"{self.base_url}/api/analyze"
        
        last_error = None
        retry_count = 0
        
        while retry_count <= max_retries:
            try:
                print(f"å˜—è©¦ç¬¬ {retry_count + 1} æ¬¡è«‹æ±‚..." if retry_count > 0 else "ç™¼é€è«‹æ±‚...")
                
                response = self.session.post(
                    url,
                    json=payload,
                    timeout=self.timeout,
                    headers={'Content-Type': 'application/json'}
                )
                
                # æˆåŠŸå›æ‡‰
                if response.status_code == 200:
                    return response.json()
                    
                # éŒ¯èª¤å›æ‡‰
                api_error = self._parse_api_error(response)
                
                # åˆ¤æ–·æ˜¯å¦é‡è©¦
                should_retry, delay = self._should_retry(
                    requests.exceptions.HTTPError(response=response), 
                    retry_count, 
                    max_retries
                )
                
                if not should_retry:
                    raise api_error
                    
                print(f"å°‡åœ¨ {delay:.2f} ç§’å¾Œé‡è©¦ (åŸå› : {api_error.error_code})")
                time.sleep(delay)
                last_error = api_error
                
            except (requests.exceptions.Timeout, requests.exceptions.ConnectionError) as e:
                should_retry, delay = self._should_retry(e, retry_count, max_retries)
                
                if not should_retry:
                    if isinstance(e, requests.exceptions.Timeout):
                        raise APIError(
                            "è«‹æ±‚è¶…æ™‚ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£æ¥æˆ–å¢åŠ è¶…æ™‚æ™‚é–“", 
                            "REQUEST_TIMEOUT", 
                            0
                        )
                    else:
                        raise APIError(
                            "ç„¡æ³•é€£æ¥åˆ° API æœå‹™ï¼Œè«‹æª¢æŸ¥æœå‹™æ˜¯å¦æ­£å¸¸é‹è¡Œ", 
                            "CONNECTION_ERROR", 
                            0
                        )
                
                print(f"ç¶²è·¯éŒ¯èª¤ï¼Œå°‡åœ¨ {delay:.2f} ç§’å¾Œé‡è©¦")
                time.sleep(delay)
                last_error = e
                
            except requests.exceptions.RequestException as e:
                raise APIError(f"è«‹æ±‚å¤±æ•—: {str(e)}", "REQUEST_ERROR", 0)
                
            retry_count += 1
            
        # è¶…éæœ€å¤§é‡è©¦æ¬¡æ•¸
        if last_error:
            if isinstance(last_error, APIError):
                raise last_error
            else:
                raise APIError(f"é‡è©¦ {max_retries} æ¬¡å¾Œä»å¤±æ•—: {str(last_error)}", "MAX_RETRIES_EXCEEDED", 0)

# ä½¿ç”¨ç¯„ä¾‹
def main():
    client = SEOAnalyzerClient()
    
    try:
        result = client.analyze_seo(
            keyword="Python ç¶²è·¯çˆ¬èŸ²",
            audience="æƒ³å­¸ç¿’è³‡æ–™æ“·å–çš„é–‹ç™¼è€…",
            options={
                "generate_draft": True,
                "include_faq": False,
                "include_table": True
            },
            max_retries=3
        )
        
        print("âœ… åˆ†æå®Œæˆ")
        print(f"è™•ç†æ™‚é–“: {result['processing_time']:.2f} ç§’")
        print(f"Token ä½¿ç”¨: {result['data']['metadata']['token_usage']}")
        
    except APIError as e:
        print(f"âŒ API éŒ¯èª¤: {e.message}")
        print(f"éŒ¯èª¤ç¢¼: {e.error_code}")
        print(f"HTTP ç‹€æ…‹: {e.status_code}")
        
        # æ ¹æ“šéŒ¯èª¤é¡å‹æä¾›å…·é«”å»ºè­°
        if e.error_code == "VALIDATION_ERROR":
            print("ğŸ’¡ å»ºè­°: è«‹æª¢æŸ¥è¼¸å…¥åƒæ•¸æ˜¯å¦ç¬¦åˆè¦æ±‚")
        elif e.error_code in ["SERP_API_ERROR", "AI_API_ERROR"]:
            print("ğŸ’¡ å»ºè­°: å¤–éƒ¨æœå‹™æš«æ™‚ä¸å¯ç”¨ï¼Œè«‹ç¨å¾Œå†è©¦")
        elif e.error_code == "PROCESSING_TIMEOUT":
            print("ğŸ’¡ å»ºè­°: å˜—è©¦é—œé–‰éƒ¨åˆ†åˆ†æé¸é …ä»¥ç¸®çŸ­è™•ç†æ™‚é–“")
        elif e.error_code == "RATE_LIMIT_EXCEEDED":
            print("ğŸ’¡ å»ºè­°: è«‹é™ä½è«‹æ±‚é »ç‡ï¼Œç¨å¾Œå†è©¦")
            
    except Exception as e:
        print(f"âŒ æœªé æœŸéŒ¯èª¤: {e}")

if __name__ == "__main__":
    main()</code></pre>
                    </div>
                </div>

                <!-- JavaScript éŒ¯èª¤è™•ç† -->
                <div class="tab-content" id="javascript">
                    <h3>JavaScript å®Œæ•´éŒ¯èª¤è™•ç†ç¯„ä¾‹</h3>
                    
                    <div class="code-example">
                        <div class="code-header">
                            <span>ç€è¦½å™¨ç«¯éŒ¯èª¤è™•ç†å’Œé‡è©¦æ©Ÿåˆ¶</span>
                            <button class="copy-btn" onclick="copyCode('js-error-handler')">è¤‡è£½</button>
                        </div>
                        <pre id="js-error-handler"><code>/**
 * API éŒ¯èª¤é¡åˆ¥
 */
class APIError extends Error {
    constructor(message, errorCode, statusCode, responseData = {}) {
        super(message);
        this.name = 'APIError';
        this.errorCode = errorCode;
        this.statusCode = statusCode;
        this.responseData = responseData;
    }
}

/**
 * é‡è©¦ç­–ç•¥æšèˆ‰
 */
const RetryStrategy = {
    NO_RETRY: 'no_retry',
    EXPONENTIAL_BACKOFF: 'exponential_backoff',
    FIXED_DELAY: 'fixed_delay'
};

/**
 * SEO Analyzer API å®¢æˆ¶ç«¯ï¼ˆå«éŒ¯èª¤è™•ç†ï¼‰
 */
class SEOAnalyzerClient {
    constructor(baseUrl = 'http://localhost:8001', timeout = 120000) {
        this.baseUrl = baseUrl;
        this.timeout = timeout;
        
        // é‡è©¦ç­–ç•¥é…ç½®
        this.retryConfig = {
            400: RetryStrategy.NO_RETRY,
            422: RetryStrategy.NO_RETRY,
            401: RetryStrategy.NO_RETRY,
            403: RetryStrategy.NO_RETRY,
            429: RetryStrategy.FIXED_DELAY,
            500: RetryStrategy.EXPONENTIAL_BACKOFF,
            502: RetryStrategy.EXPONENTIAL_BACKOFF,
            503: RetryStrategy.EXPONENTIAL_BACKOFF,
            504: RetryStrategy.EXPONENTIAL_BACKOFF,
        };
    }

    /**
     * è¨ˆç®—æŒ‡æ•¸é€€é¿å»¶é²
     */
    exponentialBackoff(retryCount, baseDelay = 1000, maxDelay = 60000) {
        const delay = Math.min(baseDelay * Math.pow(2, retryCount), maxDelay);
        const jitter = Math.random() * Math.min(1000, delay * 0.1);
        return delay + jitter;
    }

    /**
     * ç²å–é‡è©¦ç­–ç•¥
     */
    getRetryStrategy(statusCode) {
        return this.retryConfig[statusCode] || RetryStrategy.NO_RETRY;
    }

    /**
     * åˆ¤æ–·æ˜¯å¦æ‡‰è©²é‡è©¦
     */
    shouldRetry(error, retryCount, maxRetries = 3) {
        if (retryCount >= maxRetries) {
            return { shouldRetry: false, delay: 0 };
        }

        // ç¶²è·¯éŒ¯èª¤æˆ–è¶…æ™‚éŒ¯èª¤
        if (error.name === 'TypeError' || error.name === 'NetworkError' || error.message.includes('fetch')) {
            const delay = this.exponentialBackoff(retryCount);
            return { shouldRetry: true, delay };
        }

        // HTTP éŒ¯èª¤
        if (error instanceof APIError) {
            const strategy = this.getRetryStrategy(error.statusCode);
            
            switch (strategy) {
                case RetryStrategy.NO_RETRY:
                    return { shouldRetry: false, delay: 0 };
                    
                case RetryStrategy.FIXED_DELAY:
                    // ä½¿ç”¨ Retry-After æˆ–é è¨­ 60 ç§’
                    const retryAfter = error.responseData.retry_after || 60;
                    const delay = Math.min(retryAfter * 1000, 300000); // æœ€å¤š 5 åˆ†é˜
                    return { shouldRetry: true, delay };
                    
                case RetryStrategy.EXPONENTIAL_BACKOFF:
                    const backoffDelay = this.exponentialBackoff(retryCount);
                    return { shouldRetry: true, delay: backoffDelay };
                    
                default:
                    return { shouldRetry: false, delay: 0 };
            }
        }

        return { shouldRetry: false, delay: 0 };
    }

    /**
     * è§£æ API éŒ¯èª¤
     */
    async parseAPIError(response) {
        try {
            const errorData = await response.json();
            const detail = errorData.detail || {};
            
            const errorCode = typeof detail === 'object' ? 
                (detail.code || 'UNKNOWN_ERROR') : 'API_ERROR';
            const message = typeof detail === 'object' ? 
                (detail.message || `HTTP ${response.status} éŒ¯èª¤`) : String(detail);
            
            return new APIError(message, errorCode, response.status, detail);
        } catch (e) {
            return new APIError(
                `HTTP ${response.status}: ${response.statusText}`,
                'INVALID_RESPONSE',
                response.status
            );
        }
    }

    /**
     * å»¶é²å‡½æ•¸
     */
    sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    /**
     * åŸ·è¡Œ SEO åˆ†æ
     */
    async analyzeSEO(keyword, audience, options = {}, maxRetries = 3) {
        const defaultOptions = {
            generate_draft: false,
            include_faq: false,
            include_table: false
        };

        const payload = {
            keyword,
            audience,
            options: { ...defaultOptions, ...options }
        };

        let lastError = null;
        let retryCount = 0;

        while (retryCount <= maxRetries) {
            try {
                if (retryCount > 0) {
                    console.log(`å˜—è©¦ç¬¬ ${retryCount + 1} æ¬¡è«‹æ±‚...`);
                }

                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), this.timeout);

                const response = await fetch(`${this.baseUrl}/api/analyze`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload),
                    signal: controller.signal
                });

                clearTimeout(timeoutId);

                // æˆåŠŸå›æ‡‰
                if (response.ok) {
                    return await response.json();
                }

                // éŒ¯èª¤å›æ‡‰
                const apiError = await this.parseAPIError(response);
                const { shouldRetry, delay } = this.shouldRetry(apiError, retryCount, maxRetries);

                if (!shouldRetry) {
                    throw apiError;
                }

                console.log(`å°‡åœ¨ ${(delay / 1000).toFixed(2)} ç§’å¾Œé‡è©¦ (åŸå› : ${apiError.errorCode})`);
                await this.sleep(delay);
                lastError = apiError;

            } catch (error) {
                // è™•ç†ç¶²è·¯éŒ¯èª¤å’Œè¶…æ™‚
                if (error.name === 'AbortError') {
                    const timeoutError = new APIError(
                        'è«‹æ±‚è¶…æ™‚ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£æ¥æˆ–å¢åŠ è¶…æ™‚æ™‚é–“',
                        'REQUEST_TIMEOUT',
                        0
                    );
                    
                    const { shouldRetry, delay } = this.shouldRetry(timeoutError, retryCount, maxRetries);
                    if (!shouldRetry) {
                        throw timeoutError;
                    }
                    
                    console.log(`è«‹æ±‚è¶…æ™‚ï¼Œå°‡åœ¨ ${(delay / 1000).toFixed(2)} ç§’å¾Œé‡è©¦`);
                    await this.sleep(delay);
                    lastError = timeoutError;
                } else if (error instanceof APIError) {
                    // API éŒ¯èª¤å·²åœ¨ä¸Šé¢è™•ç†
                    throw error;
                } else {
                    // å…¶ä»–ç¶²è·¯éŒ¯èª¤
                    const networkError = new APIError(
                        'ç„¡æ³•é€£æ¥åˆ° API æœå‹™ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£æ¥',
                        'CONNECTION_ERROR',
                        0
                    );
                    
                    const { shouldRetry, delay } = this.shouldRetry(error, retryCount, maxRetries);
                    if (!shouldRetry) {
                        throw networkError;
                    }
                    
                    console.log(`ç¶²è·¯éŒ¯èª¤ï¼Œå°‡åœ¨ ${(delay / 1000).toFixed(2)} ç§’å¾Œé‡è©¦`);
                    await this.sleep(delay);
                    lastError = networkError;
                }
            }

            retryCount++;
        }

        // è¶…éæœ€å¤§é‡è©¦æ¬¡æ•¸
        if (lastError) {
            throw lastError;
        }

        throw new APIError(
            `é‡è©¦ ${maxRetries} æ¬¡å¾Œä»å¤±æ•—`,
            'MAX_RETRIES_EXCEEDED',
            0
        );
    }

    /**
     * å¥åº·æª¢æŸ¥
     */
    async checkHealth() {
        try {
            const response = await fetch(`${this.baseUrl}/api/health`);
            if (!response.ok) {
                throw new Error(`Health check failed: ${response.status}`);
            }
            return await response.json();
        } catch (error) {
            throw new APIError('å¥åº·æª¢æŸ¥å¤±æ•—', 'HEALTH_CHECK_FAILED', 0);
        }
    }
}

// ä½¿ç”¨ç¯„ä¾‹
async function performSEOAnalysis() {
    const client = new SEOAnalyzerClient();
    
    try {
        // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
        showLoading(true);
        updateStatus('æ­£åœ¨åŸ·è¡Œ SEO åˆ†æ...');

        const result = await client.analyzeSEO(
            'React ç‹€æ…‹ç®¡ç†',
            'å‰ç«¯é–‹ç™¼å·¥ç¨‹å¸«',
            {
                generate_draft: true,
                include_faq: true,
                include_table: false
            },
            3 // æœ€å¤šé‡è©¦ 3 æ¬¡
        );

        showLoading(false);
        displayResults(result);
        
    } catch (error) {
        showLoading(false);
        
        if (error instanceof APIError) {
            handleAPIError(error);
        } else {
            showError(`æœªé æœŸéŒ¯èª¤: ${error.message}`);
        }
    }
}

/**
 * è™•ç† API éŒ¯èª¤ä¸¦é¡¯ç¤ºé©ç•¶çš„ç”¨æˆ¶è¨Šæ¯
 */
function handleAPIError(error) {
    let userMessage = error.message;
    let suggestion = '';

    switch (error.errorCode) {
        case 'VALIDATION_ERROR':
            suggestion = 'è«‹æª¢æŸ¥æ‚¨çš„è¼¸å…¥åƒæ•¸æ˜¯å¦æ­£ç¢º';
            break;
        case 'SERP_API_ERROR':
        case 'AI_API_ERROR':
            suggestion = 'å¤–éƒ¨æœå‹™æš«æ™‚ä¸å¯ç”¨ï¼Œè«‹ç¨å¾Œå†è©¦';
            break;
        case 'PROCESSING_TIMEOUT':
            suggestion = 'è™•ç†æ™‚é–“éé•·ï¼Œå»ºè­°ç°¡åŒ–åˆ†æé¸é …';
            break;
        case 'RATE_LIMIT_EXCEEDED':
            suggestion = 'è«‹æ±‚éæ–¼é »ç¹ï¼Œè«‹ç¨å¾Œå†è©¦';
            break;
        case 'CONNECTION_ERROR':
            suggestion = 'è«‹æª¢æŸ¥ç¶²è·¯é€£æ¥';
            break;
        default:
            suggestion = 'å¦‚å•é¡ŒæŒçºŒï¼Œè«‹è¯çµ¡æŠ€è¡“æ”¯æ´';
    }

    showError(userMessage, suggestion);
}

/**
 * UI è¼”åŠ©å‡½æ•¸
 */
function showLoading(show) {
    const loader = document.getElementById('loading');
    if (loader) {
        loader.style.display = show ? 'block' : 'none';
    }
}

function updateStatus(message) {
    const status = document.getElementById('status');
    if (status) {
        status.textContent = message;
    }
}

function showError(message, suggestion = '') {
    const errorDiv = document.getElementById('error');
    if (errorDiv) {
        errorDiv.innerHTML = `
            <div class="error-message">
                <strong>éŒ¯èª¤:</strong> ${message}
                ${suggestion ? `<br><strong>å»ºè­°:</strong> ${suggestion}` : ''}
            </div>
        `;
        errorDiv.style.display = 'block';
    }
}

function displayResults(result) {
    const resultsDiv = document.getElementById('results');
    if (resultsDiv) {
        resultsDiv.innerHTML = `
            <h3>åˆ†æçµæœ</h3>
            <p><strong>è™•ç†æ™‚é–“:</strong> ${result.processing_time.toFixed(2)} ç§’</p>
            <p><strong>Token ä½¿ç”¨:</strong> ${result.data.metadata.token_usage}</p>
            <div class="analysis-content">
                ${result.data.analysis_report.replace(/\n/g, '<br>')}
            </div>
        `;
        resultsDiv.style.display = 'block';
    }
}</code></pre>
                    </div>
                </div>

                <!-- Node.js éŒ¯èª¤è™•ç† -->
                <div class="tab-content" id="nodejs">
                    <h3>Node.js å®Œæ•´éŒ¯èª¤è™•ç†ç¯„ä¾‹</h3>
                    
                    <div class="code-example">
                        <div class="code-header">
                            <span>Express.js ä¸­é–“ä»¶èˆ‡éŒ¯èª¤è™•ç†</span>
                            <button class="copy-btn" onclick="copyCode('nodejs-error-handler')">è¤‡è£½</button>
                        </div>
                        <pre id="nodejs-error-handler"><code>const axios = require('axios');
const { EventEmitter } = require('events');

/**
 * è‡ªå®šç¾© API éŒ¯èª¤é¡åˆ¥
 */
class APIError extends Error {
    constructor(message, errorCode, statusCode, responseData = {}) {
        super(message);
        this.name = 'APIError';
        this.errorCode = errorCode;
        this.statusCode = statusCode;
        this.responseData = responseData;
    }
}

/**
 * SEO Analyzer å®¢æˆ¶ç«¯ï¼ˆå«å®Œæ•´éŒ¯èª¤è™•ç†ï¼‰
 */
class SEOAnalyzerClient extends EventEmitter {
    constructor(baseUrl = process.env.SEO_API_URL || 'http://localhost:8001', options = {}) {
        super();
        
        this.baseUrl = baseUrl;
        this.timeout = options.timeout || 120000;
        this.maxRetries = options.maxRetries || 3;
        
        // å»ºç«‹ axios å¯¦ä¾‹
        this.client = axios.create({
            baseURL: baseUrl,
            timeout: this.timeout,
            headers: {
                'Content-Type': 'application/json',
            }
        });

        // é‡è©¦ç­–ç•¥é…ç½®
        this.retryConfig = {
            400: 'no_retry',
            422: 'no_retry',
            401: 'no_retry',
            403: 'no_retry',
            429: 'fixed_delay',
            500: 'exponential_backoff',
            502: 'exponential_backoff',
            503: 'exponential_backoff',
            504: 'exponential_backoff',
        };

        this.setupInterceptors();
    }

    /**
     * è¨­å®šè«‹æ±‚å’Œå›æ‡‰æ””æˆªå™¨
     */
    setupInterceptors() {
        // è«‹æ±‚æ””æˆªå™¨ - æ·»åŠ è«‹æ±‚ ID å’Œæ—¥èªŒ
        this.client.interceptors.request.use(
            (config) => {
                config.requestId = Date.now() + '-' + Math.random().toString(36).substr(2, 9);
                this.emit('request_start', { requestId: config.requestId, url: config.url });
                return config;
            },
            (error) => {
                return Promise.reject(error);
            }
        );

        // å›æ‡‰æ””æˆªå™¨ - çµ±ä¸€éŒ¯èª¤è™•ç†
        this.client.interceptors.response.use(
            (response) => {
                this.emit('request_success', { 
                    requestId: response.config.requestId, 
                    status: response.status 
                });
                return response;
            },
            async (error) => {
                const apiError = await this.parseAxiosError(error);
                this.emit('request_error', { 
                    requestId: error.config?.requestId, 
                    error: apiError 
                });
                return Promise.reject(apiError);
            }
        );
    }

    /**
     * è§£æ axios éŒ¯èª¤
     */
    async parseAxiosError(error) {
        if (error.response) {
            // HTTP éŒ¯èª¤å›æ‡‰
            const response = error.response;
            const detail = response.data?.detail || {};
            
            const errorCode = typeof detail === 'object' ? 
                (detail.code || 'API_ERROR') : 'API_ERROR';
            const message = typeof detail === 'object' ? 
                (detail.message || `HTTP ${response.status} éŒ¯èª¤`) : String(detail);
            
            return new APIError(message, errorCode, response.status, detail);
        } else if (error.code === 'ECONNREFUSED') {
            return new APIError(
                'ç„¡æ³•é€£æ¥åˆ° SEO Analyzer æœå‹™ï¼Œè«‹ç¢ºèªæœå‹™å™¨æ˜¯å¦é‹è¡Œ',
                'CONNECTION_REFUSED',
                0
            );
        } else if (error.code === 'ENOTFOUND') {
            return new APIError(
                'ç„¡æ³•è§£æåŸŸåï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£æ¥',
                'DNS_ERROR',
                0
            );
        } else if (error.code === 'ECONNABORTED' || error.message.includes('timeout')) {
            return new APIError(
                'è«‹æ±‚è¶…æ™‚ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–å¢åŠ è¶…æ™‚æ™‚é–“',
                'REQUEST_TIMEOUT',
                0
            );
        } else {
            return new APIError(
                `ç¶²è·¯éŒ¯èª¤: ${error.message}`,
                'NETWORK_ERROR',
                0
            );
        }
    }

    /**
     * æŒ‡æ•¸é€€é¿è¨ˆç®—
     */
    exponentialBackoff(retryCount, baseDelay = 1000, maxDelay = 60000) {
        const delay = Math.min(baseDelay * Math.pow(2, retryCount), maxDelay);
        const jitter = Math.random() * Math.min(1000, delay * 0.1);
        return delay + jitter;
    }

    /**
     * åˆ¤æ–·é‡è©¦ç­–ç•¥
     */
    shouldRetry(error, retryCount) {
        if (retryCount >= this.maxRetries) {
            return { shouldRetry: false, delay: 0 };
        }

        let strategy = 'no_retry';
        let delay = 0;

        if (error instanceof APIError) {
            strategy = this.retryConfig[error.statusCode] || 'no_retry';
            
            switch (strategy) {
                case 'fixed_delay':
                    delay = Math.min((error.responseData.retry_after || 60) * 1000, 300000);
                    break;
                case 'exponential_backoff':
                    delay = this.exponentialBackoff(retryCount);
                    break;
            }
        } else if (error.errorCode === 'REQUEST_TIMEOUT' || error.errorCode === 'CONNECTION_REFUSED') {
            strategy = 'exponential_backoff';
            delay = this.exponentialBackoff(retryCount);
        }

        return {
            shouldRetry: strategy !== 'no_retry',
            delay
        };
    }

    /**
     * ç¡çœ å‡½æ•¸
     */
    sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    /**
     * åŸ·è¡Œå¸¶é‡è©¦çš„ SEO åˆ†æ
     */
    async analyzeSEO(keyword, audience, options = {}) {
        const defaultOptions = {
            generate_draft: false,
            include_faq: false,
            include_table: false
        };

        const payload = {
            keyword,
            audience,
            options: { ...defaultOptions, ...options }
        };

        let lastError = null;
        let retryCount = 0;

        while (retryCount <= this.maxRetries) {
            try {
                if (retryCount > 0) {
                    this.emit('retry_attempt', { retryCount, keyword });
                }

                const response = await this.client.post('/api/analyze', payload);
                return response.data;

            } catch (error) {
                const { shouldRetry, delay } = this.shouldRetry(error, retryCount);
                
                if (!shouldRetry) {
                    throw error;
                }

                this.emit('retry_scheduled', { 
                    retryCount: retryCount + 1, 
                    delay: delay / 1000,
                    reason: error.errorCode 
                });
                
                await this.sleep(delay);
                lastError = error;
                retryCount++;
            }
        }

        // è¶…éé‡è©¦æ¬¡æ•¸
        throw new APIError(
            `é‡è©¦ ${this.maxRetries} æ¬¡å¾Œä»å¤±æ•—: ${lastError?.message}`,
            'MAX_RETRIES_EXCEEDED',
            0
        );
    }

    /**
     * æ‰¹é‡åˆ†æï¼ˆå«éŒ¯èª¤å®¹å¿ï¼‰
     */
    async batchAnalyze(keywords, audience, options = {}, concurrency = 3) {
        const results = [];
        const errors = [];
        const semaphore = new Semaphore(concurrency);

        const analysisPromises = keywords.map(async (keyword, index) => {
            await semaphore.acquire();
            
            try {
                this.emit('batch_progress', { 
                    current: index + 1, 
                    total: keywords.length, 
                    keyword 
                });

                const result = await this.analyzeSEO(keyword, audience, options);
                results.push({ keyword, success: true, data: result });
                
                // æ‰¹é‡è«‹æ±‚é–“çš„å»¶é²
                if (index < keywords.length - 1) {
                    await this.sleep(2000);
                }
                
            } catch (error) {
                this.emit('batch_error', { keyword, error });
                errors.push({ 
                    keyword, 
                    error: error.message,
                    errorCode: error.errorCode 
                });
            } finally {
                semaphore.release();
            }
        });

        await Promise.all(analysisPromises);
        return { results, errors };
    }
}

/**
 * ä¿¡è™Ÿé‡å¯¦ç¾ï¼ˆæ§åˆ¶ä½µç™¼ï¼‰
 */
class Semaphore {
    constructor(max) {
        this.max = max;
        this.current = 0;
        this.queue = [];
    }

    async acquire() {
        return new Promise((resolve) => {
            if (this.current < this.max) {
                this.current++;
                resolve();
            } else {
                this.queue.push(resolve);
            }
        });
    }

    release() {
        this.current--;
        if (this.queue.length > 0) {
            const next = this.queue.shift();
            this.current++;
            next();
        }
    }
}

/**
 * Express.js ä¸­é–“ä»¶
 */
function createSEOMiddleware(client) {
    return async (req, res, next) => {
        try {
            const { keyword, audience, options } = req.body;
            
            if (!keyword || !audience) {
                return res.status(400).json({
                    error: 'Missing required parameters: keyword and audience'
                });
            }

            const result = await client.analyzeSEO(keyword, audience, options);
            res.json(result);
            
        } catch (error) {
            next(error); // å‚³éçµ¦éŒ¯èª¤è™•ç†ä¸­é–“ä»¶
        }
    };
}

/**
 * Express.js éŒ¯èª¤è™•ç†ä¸­é–“ä»¶
 */
function errorHandler(error, req, res, next) {
    if (error instanceof APIError) {
        // æ ¹æ“šéŒ¯èª¤é¡å‹è¨­å®šé©ç•¶çš„ HTTP ç‹€æ…‹ç¢¼
        let httpStatus = 500;
        
        switch (error.errorCode) {
            case 'VALIDATION_ERROR':
                httpStatus = 400;
                break;
            case 'RATE_LIMIT_EXCEEDED':
                httpStatus = 429;
                break;
            case 'CONNECTION_REFUSED':
            case 'REQUEST_TIMEOUT':
                httpStatus = 503;
                break;
            case 'PROCESSING_TIMEOUT':
                httpStatus = 504;
                break;
        }

        res.status(httpStatus).json({
            error: {
                message: error.message,
                code: error.errorCode,
                timestamp: new Date().toISOString()
            }
        });
    } else {
        // æœªçŸ¥éŒ¯èª¤
        console.error('æœªè™•ç†çš„éŒ¯èª¤:', error);
        res.status(500).json({
            error: {
                message: 'å…§éƒ¨ä¼ºæœå™¨éŒ¯èª¤',
                code: 'INTERNAL_ERROR',
                timestamp: new Date().toISOString()
            }
        });
    }
}

// ä½¿ç”¨ç¯„ä¾‹
async function main() {
    const client = new SEOAnalyzerClient();
    
    // è¨­å®šäº‹ä»¶ç›£è½å™¨
    client.on('request_start', ({ requestId, url }) => {
        console.log(`ğŸš€ [${requestId}] è«‹æ±‚é–‹å§‹: ${url}`);
    });
    
    client.on('retry_scheduled', ({ retryCount, delay, reason }) => {
        console.log(`ğŸ”„ å°‡é€²è¡Œç¬¬ ${retryCount} æ¬¡é‡è©¦ï¼Œå»¶é² ${delay.toFixed(2)} ç§’ (åŸå› : ${reason})`);
    });
    
    client.on('batch_progress', ({ current, total, keyword }) => {
        console.log(`ğŸ“Š æ‰¹é‡é€²åº¦ ${current}/${total}: ${keyword}`);
    });

    try {
        // å–®ä¸€åˆ†æ
        const result = await client.analyzeSEO(
            'Node.js æ•ˆèƒ½å„ªåŒ–',
            'å¾Œç«¯é–‹ç™¼å·¥ç¨‹å¸«',
            { generate_draft: true, include_faq: true }
        );
        
        console.log('âœ… åˆ†æå®Œæˆ');
        console.log(`è™•ç†æ™‚é–“: ${result.processing_time} ç§’`);
        
        // æ‰¹é‡åˆ†æ
        const batchResult = await client.batchAnalyze(
            ['Express.js æ•™å­¸', 'MongoDB å„ªåŒ–', 'Docker å®¹å™¨åŒ–'],
            'å…¨ç«¯é–‹ç™¼è€…',
            { generate_draft: false, include_faq: true },
            2 // ä½µç™¼æ•¸
        );
        
        console.log(`âœ… æ‰¹é‡åˆ†æå®Œæˆ: ${batchResult.results.length} æˆåŠŸ, ${batchResult.errors.length} å¤±æ•—`);
        
    } catch (error) {
        if (error instanceof APIError) {
            console.error(`âŒ API éŒ¯èª¤: ${error.message} (${error.errorCode})`);
        } else {
            console.error(`âŒ æœªé æœŸéŒ¯èª¤:`, error);
        }
    }
}

module.exports = {
    SEOAnalyzerClient,
    APIError,
    createSEOMiddleware,
    errorHandler
};

// å¦‚æœç›´æ¥åŸ·è¡Œæ­¤æª”æ¡ˆ
if (require.main === module) {
    main().catch(console.error);
}</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç›£æ§å’Œæ—¥èªŒå»ºè­° -->
        <div class="monitoring-section">
            <h2 id="monitoring">ğŸ“Š ç›£æ§å’Œæ—¥èªŒå»ºè­°</h2>
            
            <div class="monitoring-grid">
                <div class="monitoring-card">
                    <h3>ğŸ” éŒ¯èª¤è¿½è¹¤</h3>
                    <div class="monitoring-content">
                        <h4>é—œéµæŒ‡æ¨™ï¼š</h4>
                        <ul>
                            <li>éŒ¯èª¤ç‡ (æŒ‰éŒ¯èª¤é¡å‹åˆ†é¡)</li>
                            <li>å›æ‡‰æ™‚é–“åˆ†å¸ƒ</li>
                            <li>é‡è©¦æˆåŠŸç‡</li>
                            <li>ä½µç™¼è«‹æ±‚æ•¸é‡</li>
                        </ul>
                        <h4>å‘Šè­¦æ¢ä»¶ï¼š</h4>
                        <ul>
                            <li>5xx éŒ¯èª¤ç‡ > 5%</li>
                            <li>å¹³å‡å›æ‡‰æ™‚é–“ > 45 ç§’</li>
                            <li>é‡è©¦å¤±æ•—ç‡ > 10%</li>
                        </ul>
                    </div>
                </div>

                <div class="monitoring-card">
                    <h3>ğŸ“ æ—¥èªŒè¨˜éŒ„</h3>
                    <div class="monitoring-content">
                        <h4>å¿…è¦æ—¥èªŒæ¬„ä½ï¼š</h4>
                        <ul>
                            <li>è«‹æ±‚ ID (è¿½è¹¤ç”¨)</li>
                            <li>éŒ¯èª¤ç¢¼å’Œè¨Šæ¯</li>
                            <li>è™•ç†æ™‚é–“å’Œé‡è©¦æ¬¡æ•¸</li>
                            <li>ä½¿ç”¨è€… IP å’Œ User-Agent</li>
                        </ul>
                        <h4>æ—¥èªŒç´šåˆ¥ï¼š</h4>
                        <ul>
                            <li><span class="log-error">ERROR</span>: 4xx/5xx éŒ¯èª¤</li>
                            <li><span class="log-warn">WARN</span>: é‡è©¦å’Œæ•ˆèƒ½è­¦å‘Š</li>
                            <li><span class="log-info">INFO</span>: æ­£å¸¸è«‹æ±‚</li>
                        </ul>
                    </div>
                </div>

                <div class="monitoring-card">
                    <h3>ğŸ‘¥ ä½¿ç”¨è€…é«”é©—</h3>
                    <div class="monitoring-content">
                        <h4>å‹å–„éŒ¯èª¤è¨Šæ¯ï¼š</h4>
                        <ul>
                            <li>é¿å…æš´éœ²æŠ€è¡“ç´°ç¯€</li>
                            <li>æä¾›å…·é«”çš„è§£æ±ºå»ºè­°</li>
                            <li>åŒ…å«é æœŸçš„é‡è©¦æ™‚é–“</li>
                            <li>æä¾›å®¢æœè¯çµ¡æ–¹å¼</li>
                        </ul>
                        <h4>è¼‰å…¥ç‹€æ…‹ç®¡ç†ï¼š</h4>
                        <ul>
                            <li>é¡¯ç¤ºè™•ç†é€²åº¦ (éšæ®µå¼)</li>
                            <li>é ä¼°å‰©é¤˜æ™‚é–“</li>
                            <li>å…è¨±ä½¿ç”¨è€…å–æ¶ˆè«‹æ±‚</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ•…éšœæ’é™¤æŒ‡å— -->
        <div class="troubleshooting-section">
            <h2 id="troubleshooting">ğŸ”§ æ•…éšœæ’é™¤æŒ‡å—</h2>
            
            <div class="troubleshoot-steps">
                <div class="step-card">
                    <h3>æ­¥é©Ÿ 1: åŸºæœ¬è¨ºæ–·</h3>
                    <div class="diagnostic-checklist">
                        <label><input type="checkbox"> æª¢æŸ¥ API æœå‹™å¥åº·ç‹€æ…‹ (<code>/api/health</code>)</label>
                        <label><input type="checkbox"> ç¢ºèªç¶²è·¯é€£æ¥æ­£å¸¸</label>
                        <label><input type="checkbox"> é©—è­‰è«‹æ±‚æ ¼å¼å’Œåƒæ•¸</label>
                        <label><input type="checkbox"> æª¢æŸ¥æ˜¯å¦è¶…éé€Ÿç‡é™åˆ¶</label>
                    </div>
                </div>

                <div class="step-card">
                    <h3>æ­¥é©Ÿ 2: éŒ¯èª¤åˆ†æ</h3>
                    <div class="error-analysis">
                        <p>æ ¹æ“šéŒ¯èª¤é¡å‹é€²è¡Œåˆ†æï¼š</p>
                        <div class="analysis-tabs">
                            <button class="analysis-btn" onclick="showAnalysis('4xx')">4xx éŒ¯èª¤</button>
                            <button class="analysis-btn" onclick="showAnalysis('5xx')">5xx éŒ¯èª¤</button>
                            <button class="analysis-btn" onclick="showAnalysis('network')">ç¶²è·¯éŒ¯èª¤</button>
                        </div>
                        
                        <div class="analysis-content" id="analysis-4xx">
                            <h4>å®¢æˆ¶ç«¯éŒ¯èª¤è™•ç†ï¼š</h4>
                            <ul>
                                <li>æª¢æŸ¥åƒæ•¸é¡å‹å’Œæ ¼å¼</li>
                                <li>ç¢ºèªåƒæ•¸å€¼åœ¨æœ‰æ•ˆç¯„åœå…§</li>
                                <li>é©—è­‰ JSON æ ¼å¼æ­£ç¢º</li>
                                <li>æª¢æŸ¥ Content-Type æ¨™é ­</li>
                            </ul>
                        </div>
                        
                        <div class="analysis-content" id="analysis-5xx" style="display: none;">
                            <h4>æœå‹™ç«¯éŒ¯èª¤è™•ç†ï¼š</h4>
                            <ul>
                                <li>å¯¦ä½œé‡è©¦æ©Ÿåˆ¶</li>
                                <li>æª¢æŸ¥å¤–éƒ¨æœå‹™ç‹€æ…‹</li>
                                <li>ç›£æ§ç³»çµ±è³‡æºä½¿ç”¨</li>
                                <li>æŸ¥çœ‹æœå‹™å™¨æ—¥èªŒ</li>
                            </ul>
                        </div>
                        
                        <div class="analysis-content" id="analysis-network" style="display: none;">
                            <h4>ç¶²è·¯å•é¡Œæ’é™¤ï¼š</h4>
                            <ul>
                                <li>æ¸¬è©¦ DNS è§£æ</li>
                                <li>æª¢æŸ¥é˜²ç«ç‰†è¨­å®š</li>
                                <li>é©—è­‰ SSL æ†‘è­‰</li>
                                <li>å˜—è©¦ä¸åŒçš„ç¶²è·¯ç’°å¢ƒ</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="step-card">
                    <h3>æ­¥é©Ÿ 3: è¯çµ¡æŠ€è¡“æ”¯æ´</h3>
                    <div class="support-info">
                        <p>å¦‚æœå•é¡ŒæŒçºŒå­˜åœ¨ï¼Œè«‹æä¾›ä»¥ä¸‹è³‡è¨Šï¼š</p>
                        <div class="support-checklist">
                            <label><input type="checkbox"> å®Œæ•´çš„éŒ¯èª¤è¨Šæ¯å’ŒéŒ¯èª¤ç¢¼</label>
                            <label><input type="checkbox"> è«‹æ±‚çš„å®Œæ•´ payload</label>
                            <label><input type="checkbox"> ç™¼ç”Ÿæ™‚é–“ (å«æ™‚å€)</label>
                            <label><input type="checkbox"> é‡è©¦æ¬¡æ•¸å’Œé–“éš”</label>
                            <label><input type="checkbox"> å®¢æˆ¶ç«¯ç’°å¢ƒ (ç€è¦½å™¨/Node.js ç‰ˆæœ¬ç­‰)</label>
                            <label><input type="checkbox"> ç¶²è·¯ç’°å¢ƒæè¿°</label>
                        </div>
                        
                        <div class="support-template">
                            <h4>å•é¡Œå›å ±æ¨¡æ¿ï¼š</h4>
                            <textarea readonly class="report-template">
å•é¡Œæè¿°ï¼š[ç°¡è¿°å•é¡Œ]
éŒ¯èª¤ç¢¼ï¼š[ERROR_CODE]
ç™¼ç”Ÿæ™‚é–“ï¼š[YYYY-MM-DD HH:MM:SS +TIMEZONE]
è«‹æ±‚å…§å®¹ï¼š[å®Œæ•´çš„ JSON payload]
é‡è©¦æƒ…æ³ï¼š[é‡è©¦æ¬¡æ•¸å’Œçµæœ]
å®¢æˆ¶ç«¯ç’°å¢ƒï¼š[ç€è¦½å™¨ç‰ˆæœ¬/Node.jsç‰ˆæœ¬]
å…¶ä»–è³‡è¨Šï¼š[ç›¸é—œèƒŒæ™¯è³‡è¨Š]
                            </textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.error-guide-section {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6;
    color: #2d3748;
}

.guide-intro {
    font-size: 1.1rem;
    color: #4a5568;
    margin-bottom: 30px;
    padding: 20px;
    background-color: #fed7d7;
    border-left: 4px solid #e53e3e;
    border-radius: 4px;
}

/* éŒ¯èª¤æŸ¥è©¢å€å¡Š */
.error-lookup-section {
    margin: 30px 0;
    padding: 25px;
    background: #f7fafc;
    border-radius: 10px;
    border: 1px solid #e2e8f0;
}

.error-search input {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 1rem;
    margin-bottom: 15px;
}

.error-search input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.error-categories {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.category-btn {
    padding: 8px 16px;
    border: 1px solid #e2e8f0;
    background: white;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.9rem;
}

.category-btn:hover {
    background: #edf2f7;
    border-color: #cbd5e0;
}

.category-btn.active {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

/* ç‹€æ…‹ç¢¼å€å¡Š */
.status-codes-section {
    margin: 40px 0;
}

.error-category {
    margin: 30px 0;
    padding: 25px;
    border-radius: 10px;
    border: 1px solid #e2e8f0;
}

.error-type {
    margin: 0 0 25px 0;
    padding: 15px 20px;
    border-radius: 8px;
    font-size: 1.3rem;
    font-weight: 600;
}

.client-error {
    background: linear-gradient(135deg, #fed7d7 0%, #fbb6ce 100%);
    color: #744210;
}

.server-error {
    background: linear-gradient(135deg, #ffd6cc 0%, #feb2b2 100%);
    color: #c53030;
}

.network-error {
    background: linear-gradient(135deg, #bee3f8 0%, #90cdf4 100%);
    color: #2a4365;
}

.status-code-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 20px;
}

.status-card {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border-left: 4px solid transparent;
}

.error-4xx {
    border-left-color: #f56565;
}

.error-5xx {
    border-left-color: #ed8936;
}

.status-header {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
}

.status-code {
    background: #2d3748;
    color: white;
    padding: 5px 12px;
    border-radius: 6px;
    font-family: monospace;
    font-weight: bold;
    font-size: 1rem;
}

.status-name {
    font-weight: 600;
    font-size: 1.1rem;
    color: #2d3748;
}

.status-description {
    color: #4a5568;
    margin-bottom: 15px;
}

.common-causes h5 {
    color: #2d3748;
    margin: 0 0 8px 0;
    font-size: 0.95rem;
}

.common-causes ul {
    margin: 0;
    padding-left: 20px;
}

.common-causes li {
    font-size: 0.9rem;
    color: #4a5568;
    line-height: 1.5;
    margin: 4px 0;
}

/* ç¶²è·¯éŒ¯èª¤ */
.network-errors {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.network-error-item {
    background: white;
    padding: 20px;
    border-radius: 8px;
    border-left: 4px solid #4299e1;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.network-error-item h4 {
    color: #2d3748;
    margin: 0 0 10px 0;
    font-size: 1.1rem;
    font-family: monospace;
}

.network-error-item p {
    color: #4a5568;
    margin: 0;
}

/* éŒ¯èª¤æ ¼å¼å€å¡Š */
.error-format-section {
    margin: 40px 0;
    padding: 30px 0;
    border-top: 2px solid #e2e8f0;
}

.format-explanation {
    margin-bottom: 25px;
    padding: 15px 20px;
    background: #f0f4f8;
    border-radius: 6px;
    border-left: 3px solid #4299e1;
}

.error-format-example {
    margin: 30px 0;
}

.code-example {
    margin: 20px 0;
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid #e2e8f0;
}

.code-header {
    background: #2d3748;
    color: white;
    padding: 10px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9rem;
}

.copy-btn {
    background: #667eea;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: background 0.3s;
}

.copy-btn:hover {
    background: #5a67d8;
}

.code-example pre {
    background: #1a202c;
    color: #e2e8f0;
    padding: 20px;
    margin: 0;
    overflow-x: auto;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 0.9rem;
    line-height: 1.4;
}

/* éŒ¯èª¤ç¢¼è¡¨æ ¼ */
.error-codes-table {
    margin: 30px 0;
}

.error-codes-list {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    overflow: hidden;
}

.error-codes-list th {
    background: #2d3748;
    color: white;
    padding: 15px;
    text-align: left;
    font-weight: 600;
}

.error-codes-list td {
    padding: 12px 15px;
    border-bottom: 1px solid #e2e8f0;
}

.error-codes-list tr:hover {
    background: #f7fafc;
}

.error-codes-list code {
    background: #edf2f7;
    padding: 3px 6px;
    border-radius: 3px;
    font-family: monospace;
    color: #d63384;
}

.status-400 { color: #f56565; font-weight: 600; }
.status-429 { color: #ed8936; font-weight: 600; }
.status-500 { color: #e53e3e; font-weight: 600; }
.status-503 { color: #dd6b20; font-weight: 600; }
.status-504 { color: #d69e2e; font-weight: 600; }

.retry-no { color: #e53e3e; }
.retry-yes { color: #38a169; }
.retry-maybe { color: #d69e2e; }
.retry-delay { color: #3182ce; }

/* é‡è©¦ç­–ç•¥å€å¡Š */
.retry-section {
    margin: 40px 0;
    padding: 30px 0;
    border-top: 2px solid #e2e8f0;
}

.retry-strategy-overview {
    margin-bottom: 25px;
    padding: 15px 20px;
    background: #e6fffa;
    border-radius: 6px;
    border-left: 3px solid #38b2ac;
}

.retry-strategies {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 25px;
    margin: 30px 0;
}

.strategy-card {
    background: white;
    border-radius: 10px;
    padding: 25px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border-left: 5px solid transparent;
}

.retry-exponential {
    border-left-color: #4299e1;
}

.retry-fixed {
    border-left-color: #ed8936;
}

.retry-none {
    border-left-color: #e53e3e;
}

.strategy-card h3 {
    color: #2d3748;
    margin: 0 0 15px 0;
    font-size: 1.2rem;
}

.strategy-card p {
    color: #4a5568;
    margin-bottom: 20px;
}

.strategy-details h4 {
    color: #2d3748;
    margin: 15px 0 8px 0;
    font-size: 1rem;
}

.strategy-details code {
    background: #f7fafc;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: monospace;
    color: #d63384;
    display: block;
    margin: 8px 0;
}

.strategy-details ul {
    margin: 8px 0;
    padding-left: 20px;
}

.strategy-details li {
    margin: 5px 0;
    color: #4a5568;
}

/* ç¨‹å¼ç¢¼ç¯„ä¾‹æ¨™ç±¤ */
.code-examples-section {
    margin: 40px 0;
    padding: 30px 0;
    border-top: 2px solid #e2e8f0;
}

.language-tabs {
    margin: 20px 0;
}

.tab-buttons {
    display: flex;
    gap: 5px;
    margin-bottom: 20px;
    border-bottom: 2px solid #e2e8f0;
}

.tab-btn {
    padding: 10px 20px;
    border: none;
    background: #f7fafc;
    color: #4a5568;
    cursor: pointer;
    border-radius: 6px 6px 0 0;
    font-weight: 500;
    transition: all 0.3s ease;
}

.tab-btn:hover {
    background: #e2e8f0;
}

.tab-btn.active {
    background: #667eea;
    color: white;
}

.tab-content {
    display: none;
    padding: 20px 0;
}

.tab-content.active {
    display: block;
}

/* ç›£æ§å€å¡Š */
.monitoring-section {
    margin: 40px 0;
    padding: 30px 0;
    border-top: 2px solid #e2e8f0;
}

.monitoring-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 25px;
    margin: 30px 0;
}

.monitoring-card {
    background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
    border-radius: 10px;
    padding: 25px;
    border-left: 5px solid #667eea;
}

.monitoring-card h3 {
    color: #2d3748;
    margin: 0 0 20px 0;
    font-size: 1.2rem;
}

.monitoring-content h4 {
    color: #2d3748;
    margin: 15px 0 8px 0;
    font-size: 1rem;
}

.monitoring-content ul {
    margin: 8px 0;
    padding-left: 20px;
}

.monitoring-content li {
    margin: 5px 0;
    color: #4a5568;
}

.log-error { 
    background: #fed7d7; 
    color: #c53030; 
    padding: 2px 6px; 
    border-radius: 3px;
    font-family: monospace;
}

.log-warn { 
    background: #feebc8; 
    color: #d69e2e; 
    padding: 2px 6px; 
    border-radius: 3px;
    font-family: monospace;
}

.log-info { 
    background: #bee3f8; 
    color: #3182ce; 
    padding: 2px 6px; 
    border-radius: 3px;
    font-family: monospace;
}

/* æ•…éšœæ’é™¤å€å¡Š */
.troubleshooting-section {
    margin: 40px 0;
    padding: 30px 0;
    border-top: 2px solid #e2e8f0;
}

.troubleshoot-steps {
    display: flex;
    flex-direction: column;
    gap: 25px;
    margin: 30px 0;
}

.step-card {
    background: white;
    border-radius: 10px;
    padding: 25px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border-left: 5px solid #48bb78;
}

.step-card h3 {
    color: #2d3748;
    margin: 0 0 20px 0;
    font-size: 1.2rem;
}

.diagnostic-checklist {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.diagnostic-checklist label {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    background: #f7fafc;
    border-radius: 6px;
    cursor: pointer;
}

.diagnostic-checklist input[type="checkbox"] {
    transform: scale(1.2);
}

.analysis-tabs {
    display: flex;
    gap: 10px;
    margin: 15px 0;
}

.analysis-btn {
    padding: 8px 16px;
    border: 1px solid #e2e8f0;
    background: white;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.analysis-btn:hover {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

.analysis-content {
    margin: 15px 0;
    padding: 15px;
    background: #f7fafc;
    border-radius: 6px;
}

.support-checklist {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin: 15px 0;
}

.support-checklist label {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 8px;
    background: #f0fff4;
    border-radius: 4px;
    cursor: pointer;
}

.support-template {
    margin: 20px 0;
}

.report-template {
    width: 100%;
    height: 200px;
    padding: 15px;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    font-family: monospace;
    font-size: 0.9rem;
    background: #f7fafc;
    resize: vertical;
}

/* éŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 768px) {
    .status-code-grid,
    .retry-strategies,
    .monitoring-grid {
        grid-template-columns: 1fr;
    }
    
    .tab-buttons {
        overflow-x: auto;
    }
    
    .tab-btn {
        flex-shrink: 0;
    }
    
    .error-categories {
        justify-content: flex-start;
        overflow-x: auto;
    }
    
    .category-btn {
        flex-shrink: 0;
    }
}
</style>

<script>
// éŒ¯èª¤æŸ¥è©¢åŠŸèƒ½
function filterErrors() {
    const searchTerm = document.getElementById('errorSearch').value.toLowerCase();
    const cards = document.querySelectorAll('.status-card, .network-error-item, .error-codes-list tr');
    
    cards.forEach(card => {
        const text = card.textContent.toLowerCase();
        if (text.includes(searchTerm)) {
            card.style.display = '';
        } else {
            card.style.display = 'none';
        }
    });
}

// éŒ¯èª¤åˆ†é¡ç¯©é¸
function showErrorCategory(category) {
    const categories = document.querySelectorAll('.error-category');
    const buttons = document.querySelectorAll('.category-btn');
    
    // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
    buttons.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // é¡¯ç¤º/éš±è—åˆ†é¡
    categories.forEach(cat => {
        if (category === 'all' || cat.dataset.category === category) {
            cat.style.display = 'block';
        } else {
            cat.style.display = 'none';
        }
    });
}

// ç¨‹å¼ç¢¼æ¨™ç±¤åˆ‡æ›
function showCodeTab(tabName) {
    // éš±è—æ‰€æœ‰æ¨™ç±¤å…§å®¹
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active ç‹€æ…‹
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // é¡¯ç¤ºé¸ä¸­çš„æ¨™ç±¤
    document.getElementById(tabName).classList.add('active');
    
    // è¨­å®šå°æ‡‰æŒ‰éˆ•ç‚º active
    event.target.classList.add('active');
}

// éŒ¯èª¤åˆ†ææ¨™ç±¤
function showAnalysis(type) {
    document.querySelectorAll('.analysis-content').forEach(content => {
        content.style.display = 'none';
    });
    
    document.querySelectorAll('.analysis-btn').forEach(btn => {
        btn.style.background = 'white';
        btn.style.color = '#4a5568';
        btn.style.borderColor = '#e2e8f0';
    });
    
    document.getElementById('analysis-' + type).style.display = 'block';
    event.target.style.background = '#667eea';
    event.target.style.color = 'white';
    event.target.style.borderColor = '#667eea';
}

// è¤‡è£½ç¨‹å¼ç¢¼åŠŸèƒ½
function copyCode(elementId) {
    const element = document.getElementById(elementId);
    const text = element.textContent;
    
    navigator.clipboard.writeText(text).then(function() {
        const button = element.closest('.code-example').querySelector('.copy-btn');
        const originalText = button.textContent;
        button.textContent = 'å·²è¤‡è£½!';
        button.style.background = '#48bb78';
        
        setTimeout(function() {
            button.textContent = originalText;
            button.style.background = '#667eea';
        }, 2000);
    }).catch(function(err) {
        console.error('è¤‡è£½å¤±æ•—:', err);
    });
}
</script>